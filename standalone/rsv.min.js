"undefined"==typeof rsv&&(rsv={}),rsv.displayType="alert-all",rsv.errorFieldClass=null,rsv.errorTextIntro="Please fix the following error(s) and resubmit:",rsv.errorJSItemBullet="* ",rsv.errorHTMLItemBullet="&bull; ",rsv.errorTargetElementId="rsvErrors",rsv.customErrorHandler=null,rsv.onCompleteHandler=null,rsv.validate=function(form,rules){rsv.returnHash=[];for(var i=0;i<rules.length;i++){var row=rules[i].replace(/\\,/gi,"%%C%%");row=row.split(",");for(var satisfiesIfConditions=!0;row[0].match("^if:");){var cond=row[0];cond=cond.replace("if:","");var comparison="equal",parts=[];-1!=cond.search("!=")?(parts=cond.split("!="),comparison="not_equal"):parts=cond.split("=");var fieldToCheck=parts[0],valueToCheck=parts[1],fieldnameValue="";if(void 0==form[fieldToCheck].type)for(var j=0;j<form[fieldToCheck].length;j++)form[fieldToCheck][j].checked&&(fieldnameValue=form[fieldToCheck][j].value);else"checkbox"==form[fieldToCheck].type?form[fieldToCheck].checked&&(fieldnameValue=form[parts[0]].value):fieldnameValue=form[parts[0]].value;if("equal"==comparison&&fieldnameValue!=valueToCheck){satisfiesIfConditions=!1;break}if("not_equal"==comparison&&fieldnameValue==valueToCheck){satisfiesIfConditions=!1;break}row.shift()}if(satisfiesIfConditions){var requirement=row[0],fieldName=row[1],fieldName2,fieldName3,errorMessage,lengthRequirements,date_flag;if("function"!=requirement&&void 0==form[fieldName])return alert('RSV Error: the field "'+fieldName+"\" doesn't exist! Please check your form and settings."),!1;if("function"!=requirement&&rsv.errorFieldClass)if(void 0==form[fieldName].type)for(var j=0;j<form[fieldName].length;j++)rsv.removeClassName(form[fieldName][j],rsv.errorFieldClass,!0);else rsv.removeClassName(form[fieldName],rsv.errorFieldClass);switch(6==row.length?(fieldName2=row[2],fieldName3=row[3],date_flag=row[4],errorMessage=row[5]):5==row.length?(fieldName2=row[2],fieldName3=row[3],errorMessage=row[4]):4==row.length?(fieldName2=row[2],errorMessage=row[3]):errorMessage=row[2],requirement.match("^length")&&(lengthRequirements=requirement,requirement="length"),requirement.match("^range")&&(rangeRequirements=requirement,requirement="range"),requirement){case"required":if(void 0==form[fieldName].type){for(var oneIsChecked=!1,j=0;j<form[fieldName].length;j++)form[fieldName][j].checked&&(oneIsChecked=!0);if(!oneIsChecked&&!rsv.processError(form[fieldName],errorMessage))return!1}else if("select-multiple"==form[fieldName].type){for(var oneIsSelected=!1,k=0;k<form[fieldName].length;k++)form[fieldName][k].selected&&(oneIsSelected=!0);if(!(oneIsSelected&&0!=form[fieldName].length||rsv.processError(form[fieldName],errorMessage)))return!1}else if("checkbox"==form[fieldName].type){if(!form[fieldName].checked&&!rsv.processError(form[fieldName],errorMessage))return!1}else if(!form[fieldName].value&&!rsv.processError(form[fieldName],errorMessage))return!1;break;case"digits_only":if(form[fieldName].value&&form[fieldName].value.match(/\D/)&&!rsv.processError(form[fieldName],errorMessage))return!1;break;case"letters_only":if(form[fieldName].value&&form[fieldName].value.match(/[^a-zA-Z]/)&&!rsv.processError(form[fieldName],errorMessage))return!1;break;case"is_alpha":if(form[fieldName].value&&form[fieldName].value.match(/\W/)&&!rsv.processError(form[fieldName],errorMessage))return!1;break;case"custom_alpha":for(var conversion={L:"[A-Z]",V:"[AEIOU]",l:"[a-z]",v:"[aeiou]",D:"[a-zA-Z]",F:"[aeiouAEIOU]",C:"[BCDFGHJKLMNPQRSTVWXYZ]",x:"[0-9]",c:"[bcdfghjklmnpqrstvwxyz]",X:"[1-9]",E:"[bcdfghjklmnpqrstvwxyzBCDFGHJKLMNPQRSTVWXYZ]"},reg_exp_str="",j=0;j<fieldName2.length;j++)reg_exp_str+=conversion[fieldName2.charAt(j)]?conversion[fieldName2.charAt(j)]:fieldName2.charAt(j);var reg_exp=new RegExp(reg_exp_str);if(form[fieldName].value&&null==reg_exp.exec(form[fieldName].value)&&!rsv.processError(form[fieldName],errorMessage))return!1;break;case"reg_exp":var reg_exp_str=fieldName2.replace(/%%C%%/gi,",");if(5==row.length)var reg_exp=new RegExp(reg_exp_str,fieldName3);else var reg_exp=new RegExp(reg_exp_str);if(form[fieldName].value&&null==reg_exp.exec(form[fieldName].value)&&!rsv.processError(form[fieldName],errorMessage))return!1;break;case"length":switch(comparison_rule="",rule_string="",lengthRequirements.match(/length=/)?(comparison_rule="equal",rule_string=lengthRequirements.replace("length=","")):lengthRequirements.match(/length>=/)?(comparison_rule="greater_than_or_equal",rule_string=lengthRequirements.replace("length>=","")):lengthRequirements.match(/length>/)?(comparison_rule="greater_than",rule_string=lengthRequirements.replace("length>","")):lengthRequirements.match(/length<=/)?(comparison_rule="less_than_or_equal",rule_string=lengthRequirements.replace("length<=","")):lengthRequirements.match(/length</)&&(comparison_rule="less_than",rule_string=lengthRequirements.replace("length<","")),comparison_rule){case"greater_than_or_equal":if(!(form[fieldName].value.length>=parseInt(rule_string)||rsv.processError(form[fieldName],errorMessage)))return!1;break;case"greater_than":if(!(form[fieldName].value.length>parseInt(rule_string)||rsv.processError(form[fieldName],errorMessage)))return!1;break;case"less_than_or_equal":if(!(form[fieldName].value.length<=parseInt(rule_string)||rsv.processError(form[fieldName],errorMessage)))return!1;break;case"less_than":if(!(form[fieldName].value.length<parseInt(rule_string)||rsv.processError(form[fieldName],errorMessage)))return!1;break;case"equal":var range_or_exact_number=rule_string.match(/[^_]+/),fieldCount=range_or_exact_number[0].split("-");if(2==fieldCount.length){if((form[fieldName].value.length<fieldCount[0]||form[fieldName].value.length>fieldCount[1])&&!rsv.processError(form[fieldName],errorMessage))return!1}else if(form[fieldName].value.length!=fieldCount[0]&&!rsv.processError(form[fieldName],errorMessage))return!1}break;case"valid_email":if(form[fieldName].value&&!rsv.isValidEmail(form[fieldName].value)&&!rsv.processError(form[fieldName],errorMessage))return!1;break;case"valid_date":var isLaterDate=!1;if("later_date"==date_flag?isLaterDate=!0:"any_date"==date_flag&&(isLaterDate=!1),!rsv.isValidDate(form[fieldName].value,form[fieldName2].value,form[fieldName3].value,isLaterDate)&&!rsv.processError(form[fieldName],errorMessage))return!1;break;case"same_as":if(form[fieldName].value!=form[fieldName2].value&&!rsv.processError(form[fieldName],errorMessage))return!1;break;case"range":switch(comparison_rule="",rule_string="",rangeRequirements.match(/range=/)?(comparison_rule="equal",rule_string=rangeRequirements.replace("range=","")):rangeRequirements.match(/range>=/)?(comparison_rule="greater_than_or_equal",rule_string=rangeRequirements.replace("range>=","")):rangeRequirements.match(/range>/)?(comparison_rule="greater_than",rule_string=rangeRequirements.replace("range>","")):rangeRequirements.match(/range<=/)?(comparison_rule="less_than_or_equal",rule_string=rangeRequirements.replace("range<=","")):rangeRequirements.match(/range</)&&(comparison_rule="less_than",rule_string=rangeRequirements.replace("range<","")),comparison_rule){case"greater_than_or_equal":if(!(form[fieldName].value>=Number(rule_string)||rsv.processError(form[fieldName],errorMessage)))return!1;break;case"greater_than":if(!(form[fieldName].value>Number(rule_string)||rsv.processError(form[fieldName],errorMessage)))return!1;break;case"less_than_or_equal":if(!(form[fieldName].value<=Number(rule_string)||rsv.processError(form[fieldName],errorMessage)))return!1;break;case"less_than":if(!(form[fieldName].value<Number(rule_string)||rsv.processError(form[fieldName],errorMessage)))return!1;break;case"equal":var rangeValues=rule_string.split("-");if((form[fieldName].value<Number(rangeValues[0])||form[fieldName].value>Number(rangeValues[1]))&&!rsv.processError(form[fieldName],errorMessage))return!1}break;case"function":if(custom_function=fieldName,eval("var result = "+custom_function+"()"),-1!=result.constructor.toString().indexOf("Array"))for(var j=0;j<result.length;j++)if(!rsv.processError(result[j][0],result[j][1]))return!1;break;default:return alert("Unknown requirement flag in validateFields(): "+requirement),!1}}}if("function"==typeof rsv.customErrorHandler)return rsv.customErrorHandler(form,rsv.returnHash);if("alert-all"==rsv.displayType){for(var errorStr=rsv.errorTextIntro+"\n\n",i=0;i<rsv.returnHash.length;i++)errorStr+=rsv.errorJSItemBullet+rsv.returnHash[i][1]+"\n",rsv.styleField(rsv.returnHash[i][0],0==i);if(rsv.returnHash.length>0)return alert(errorStr),!1}else if("display-html"==rsv.displayType){var success=rsv.displayHTMLErrors(form,rsv.returnHash);if(!success)return!1}return"function"==typeof rsv.onCompleteHandler?rsv.onCompleteHandler():!0},rsv.processError=function(a,b){b=b.replace(/%%C%%/gi,",");var c=!0;switch(rsv.displayType){case"alert-one":alert(b),rsv.styleField(a,!0),c=!1;break;case"alert-all":case"display-html":rsv.returnHash.push([a,b])}return c},rsv.displayHTMLErrors=function(a,b){for(var c=rsv.errorTextIntro+"<br /><br />",d=0;d<b.length;d++)c+=rsv.errorHTMLItemBullet+b[d][1]+"<br />",rsv.styleField(b[d][0],0==d);return b.length>0?(document.getElementById(rsv.errorTargetElementId).style.display="block",document.getElementById(rsv.errorTargetElementId).innerHTML=c,!1):!0},rsv.styleField=function(a,b){if(rsv.errorFieldClass)if(void 0==a.type){b&&a[0].focus();for(var c=0;c<a.length;c++)rsv.addClassName(a[c],rsv.errorFieldClass,!0)}else rsv.errorFieldClass&&rsv.addClassName(a,rsv.errorFieldClass,!0),b&&a.focus()},rsv.isValidEmail=function(a){var b=a.replace(/^\s*/,""),c=b.replace(/\s*$/,""),d="@",e=".",f=c.indexOf(d),g=c.length;return-1==c.indexOf(d)||-1==c.indexOf(d)||0==c.indexOf(d)||c.indexOf(d)==g||-1==c.indexOf(e)||0==c.indexOf(e)||c.indexOf(e)==g||-1!=c.indexOf(d,f+1)||c.substring(f-1,f)==e||c.substring(f+1,f+2)==e||-1==c.indexOf(e,f+2)||-1!=c.indexOf(" ")?!1:!0},rsv.isWhitespace=function(a){var b=" 	\n\r\f";if(null==a||0==a.length)return!0;for(var c=0;c<a.length;c++){var d=a.charAt(c);if(-1==b.indexOf(d))return!1}return!0},rsv.isValidDate=function(a,b,c,d){var e;if(e=c%4!=0||c%100==0&&c%400!=0?[31,28,31,30,31,30,31,31,30,31,30,31]:[31,29,31,30,31,30,31,31,30,31,30,31],!a||!b||!c)return!1;if(1>a||a>12)return!1;if(0>c)return!1;if(1>b||b>e[a-1])return!1;if(d){var f=new Date,g=f.getMonth()+1,h=f.getDate(),i=f.getFullYear();1==String(g).length&&(g="0"+g),1==String(h).length&&(h="0"+h);var j=String(i)+String(g)+String(h);if(1==String(a).length&&(a="0"+a),1==String(b).length&&(b="0"+b),incomingDate=String(c)+String(a)+String(b),Number(j)>Number(incomingDate))return!1}return!0},rsv.addClassName=function(a,b,c){if(a.className){var d=a.className.split(" ");if(c)for(var e=b.toUpperCase(),f=0;f<d.length;f++)d[f].toUpperCase()==e&&(d.splice(f,1),f--);d[d.length]=b,a.className=d.join(" ")}else a.className=b},rsv.removeClassName=function(a,b){if(a.className){for(var c=a.className.split(" "),d=b.toUpperCase(),e=0;e<c.length;e++)c[e].toUpperCase()==d&&(c.splice(e,1),e--);a.className=c.join(" ")}};